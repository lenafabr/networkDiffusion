PROGRAM MAIN
  ! test various subroutines
  USE KEYS
  USE NETWORKUTIL
  USE GENUTIL
  USE TESTMOD
  IMPLICIT NONE
  TYPE(NETWORK), TARGET :: NET
  TYPE(NETWORK), POINTER :: NETP

  NETP=>NET

  CALL READKEY

  CALL TESTFZERO
  !CALL TESTNETWORKFROMFILE
  
CONTAINS
  
  
  SUBROUTINE TESTNETWORKFROMFILE
    ! test ability to read in network from file
    IMPLICIT NONE
    INTEGER :: EI, NI
    
    CALL NETWORKFROMFILE(NETP,NETFILE)

    PRINT*, 'Edge connectivities and lengths:'
    DO EI = 1,NETP%NEDGE
       PRINT*, EI, NETP%EDGENODE(EI,:), NETP%EDGELEN(EI)
    END DO

    PRINT*, 'Edges connected to each node:'
    DO NI = 1,NETP%NNODE
       PRINT*, NI, NETP%NODEEDGE(NI,1:NETP%NODEDEG(NI))
    ENDDO
    
    PRINT*, 'Nodes connected to each node:'
    DO NI = 1,NETP%NNODE
       PRINT*, NI, NETP%NODENODE(NI,1:NETP%NODEDEG(NI))
    ENDDO
    
  END SUBROUTINE TESTNETWORKFROMFILE

 
END PROGRAM MAIN
